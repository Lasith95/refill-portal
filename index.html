<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Refill Reserve | Staff Portal</title>

    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="logo.png">
    <link rel="icon" type="image/png" href="logo.png">
    <meta name="theme-color" content="#0f1113">

    <style>
        :root {
            --bg-body: #0f1113;
            --bg-card: #1c1f22;
            --accent: #d4af37;
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --error: #e74c3c;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg-body); color: var(--text-primary); margin: 0; padding: 20px; }

        /* SPLASH */
        #splash-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg-body); display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 20000; transition: opacity 0.6s; }
        .splash-logo { width: 120px; animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { transform: scale(0.95); opacity: 0.8; } 50% { transform: scale(1); opacity: 1; } }

        /* LOGIN */
        #login-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg-body); display: flex; justify-content: center; align-items: center; z-index: 10000; }
        .login-box { background: var(--bg-card); padding: 40px; border-radius: 8px; border: 1px solid var(--accent); text-align: center; width: 90%; max-width: 400px; }
        input { padding: 15px; width: 100%; background: #252a2e; border: 1px solid #444; color: white; margin-bottom: 20px; border-radius: 4px; text-align: center; }

        /* NAV */
        h1 { font-size: 1.2rem; letter-spacing: 4px; color: var(--accent); text-transform: uppercase; text-align: center; }
        .nav-tabs { display: flex; justify-content: center; gap: 8px; margin-bottom: 20px; }
        .tab-btn { background: transparent; border: 1px solid #444; color: var(--text-secondary); padding: 10px 15px; border-radius: 4px; font-size: 0.7rem; font-weight: bold; cursor: pointer; }
        .tab-btn.active { background: var(--accent); color: #000; border-color: var(--accent); }

        .category-nav { display: flex; overflow-x: auto; gap: 8px; padding-bottom: 10px; margin-bottom: 20px; scrollbar-width: none; }
        .cat-btn { white-space: nowrap; background: #1c1f22; border: 1px solid #333; color: #888; padding: 8px 15px; border-radius: 20px; font-size: 0.7rem; }
        .cat-btn.active { border-color: var(--accent); color: var(--accent); }

        .search-bar { width: 100%; padding: 15px; background: #1c1f22; border: 1px solid #333; border-bottom: 2px solid var(--accent); color: white; margin-bottom: 20px; }

        /* GRID & CARDS */
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
        .card { height: 350px; perspective: 1000px; }
        .card-inner { position: relative; width: 100%; height: 100%; transition: transform 0.6s; transform-style: preserve-3d; }
        .card.flipped .card-inner { transform: rotateY(180deg); }
        .card-front, .card-back { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 8px; padding: 20px; }
        .card-front { background: var(--bg-card); border: 1px solid #333; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; }
        .card-back { background: #fff; color: #1a1a1a; transform: rotateY(180deg); overflow-y: auto; }
        
        .cat-tag { font-size: 0.6rem; padding: 3px 8px; border-radius: 4px; color: #fff; text-transform: uppercase; margin-bottom: 10px; display: inline-block; }
        .label { font-weight: 800; font-size: 0.6rem; color: #888; text-transform: uppercase; margin-top: 10px; display: block; border-bottom: 1px solid #eee; }
        
        #popup-overlay { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:30000; justify-content:center; align-items:center; }
        .popup-box { background:#fff; color:#000; padding:30px; border-radius:8px; width:90%; max-width:500px; }
    </style>
</head>
<body>

<div id="splash-screen"><img src="logo.png" class="splash-logo"></div>

<div id="login-screen">
    <div class="login-box">
        <h2 style="color:var(--accent)">REFILL ACCESS</h2>
        <input type="password" id="passInput" placeholder="Password">
        <button class="tab-btn active" style="width:100%" onclick="checkAuth()">Login</button>
    </div>
</div>

<div id="main-content" style="display:none">
    <h1>Refill Reserve</h1>
    <div class="nav-tabs">
        <button class="tab-btn active" id="b-recipes" onclick="showTab('recipes')">Recipes</button>
        <button class="tab-btn" id="b-quiz" onclick="showTab('quiz')">Quiz</button>
        <button class="tab-btn" id="b-contacts" onclick="showTab('contacts')">Contacts</button>
        <button class="tab-btn" id="b-docs" onclick="showTab('docs')">Docs</button>
    </div>

    <div id="sec-recipes">
        <div class="category-nav" id="catNav">
            <button class="cat-btn active" onclick="filterCat('All', this)">All</button>
        </div>
        <input type="text" id="searchInput" class="search-bar" placeholder="Search drinks..." onkeyup="renderRecipes()">
        <div class="grid" id="recipeGrid"></div>
    </div>

    <div id="sec-quiz" style="display:none">
        <div class="login-box" style="margin:auto; width:100%">
            <p id="q-text" style="font-size:1.1rem">Loading Question...</p>
            <div id="q-options" style="display:flex; flex-direction:column; gap:10px"></div>
        </div>
    </div>

    <div id="sec-contacts" style="display:none" class="grid"></div>

    <div id="sec-docs" style="display:none" class="grid"></div>
</div>

<div id="popup-overlay">
    <div class="popup-box">
        <h2 style="color:var(--error)">INCORRECT</h2>
        <div id="p-details" style="margin:20px 0; text-align:left"></div>
        <button class="tab-btn active" style="width:100%" onclick="closePopup()">Try Next</button>
    </div>
</div>

<script>
const MASTER_PASS = "Refill2024";
const API_URL = 'PASTE_YOUR_URL_HERE'; 
let db = { recipes: [], contacts: [], documents: [] };
let activeCat = "All";
let currentQ = null;

async function loadData() {
    try {
        const res = await fetch(API_URL);
        db = await res.json();
        setupCatNav();
        renderRecipes();
    } catch (e) { console.error("Data Load Failed"); }
}

window.onload = () => {
    loadData();
    setTimeout(() => { document.getElementById('splash-screen').style.opacity='0'; 
    setTimeout(() => document.getElementById('splash-screen').style.display='none', 600); }, 2000);
};

function checkAuth() {
    if(document.getElementById('passInput').value === MASTER_PASS) {
        document.getElementById('login-screen').style.display = 'none';
        document.getElementById('main-content').style.display = 'block';
    } else { alert("Access Denied"); }
}

function showTab(t) {
    ['recipes','quiz','contacts','docs'].forEach(s => {
        document.getElementById('sec-'+s).style.display = (s===t) ? (t==='quiz'?'block':'grid') : 'none';
        document.getElementById('b-'+s).classList.toggle('active', s===t);
    });
    if(t==='quiz') startQuiz();
    if(t==='contacts') renderContacts();
    if(t==='docs') renderDocs();
}

function setupCatNav() {
    const cats = [...new Set(db.recipes.map(r => r.cat))];
    const nav = document.getElementById('catNav');
    cats.forEach(c => {
        const b = document.createElement('button');
        b.className = 'cat-btn'; b.innerText = c;
        b.onclick = () => filterCat(c, b);
        nav.appendChild(b);
    });
}

function filterCat(c, b) {
    activeCat = c;
    document.querySelectorAll('.cat-btn').forEach(btn => btn.classList.remove('active'));
    b.classList.add('active');
    renderRecipes();
}

function renderRecipes() {
    const grid = document.getElementById('recipeGrid');
    const q = document.getElementById('searchInput').value.toLowerCase();
    grid.innerHTML = '';
    db.recipes.filter(r => (activeCat==="All" || r.cat===activeCat) && r.name.toLowerCase().includes(q)).forEach(r => {
        const d = document.createElement('div');
        d.className = 'card'; d.onclick = () => d.classList.toggle('flipped');
        d.innerHTML = `<div class="card-inner">
            <div class="card-front"><span class="cat-tag" style="background:${r.color}">${r.cat}</span><h2>${r.name}</h2></div>
            <div class="card-back"><strong>${r.name}</strong><span class="label">Ing</span><div>${r.ing}</div><span class="label">Method</span><div>${r.method}</div></div>
        </div>`;
        grid.appendChild(d);
    });
}

function renderContacts() {
    const grid = document.getElementById('sec-contacts');
    grid.innerHTML = '';
    db.contacts.forEach(c => {
        grid.innerHTML += `<div class="card-front" style="height:150px"><h3>${c.name}</h3><p>${c.role}</p><a href="tel:${c.phone}" style="color:var(--accent)">${c.phone}</a></div>`;
    });
}

function renderDocs() {
    const grid = document.getElementById('sec-docs');
    grid.innerHTML = '';
    db.documents.forEach(d => {
        grid.innerHTML += `<div class="card-front" style="height:150px"><h3>${d.name}</h3><a href="${d.file}" style="color:var(--accent)">VIEW PDF</a></div>`;
    });
}

function startQuiz() {
    currentQ = db.recipes[Math.floor(Math.random()*db.recipes.length)];
    document.getElementById('q-text').innerText = "Ingredients for " + currentQ.name + "?";
    let opts = [currentQ.ing];
    while(opts.length<4) { let r = db.recipes[Math.floor(Math.random()*db.recipes.length)].ing; if(!opts.includes(r)) opts.push(r); }
    opts.sort(()=>Math.random()-0.5);
    const container = document.getElementById('q-options');
    container.innerHTML = '';
    opts.forEach(o => {
        const b = document.createElement('button'); b.className='tab-btn'; b.style.color="white"; b.innerText=o;
        b.onclick = () => (o === currentQ.ing) ? startQuiz() : showPopup();
        container.appendChild(b);
    });
}

function showPopup() {
    document.getElementById('p-details').innerHTML = `<strong>${currentQ.name}</strong><br><br>${currentQ.ing}`;
    document.getElementById('popup-overlay').style.display='flex';
}
function closePopup() { document.getElementById('popup-overlay').style.display='none'; startQuiz(); }
</script>
</body>
</html>
